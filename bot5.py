import logging
import random
import asyncio
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, CallbackQueryHandler, MessageHandler, filters, ContextTypes

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞
BOT_TOKEN = "8485511386:AAEN7QDoC_WFVwca5OS-xY7pB0hGJ2YokbM"

# –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ—Ç–∞
NEXT_BOT_LINK = "@Arkasha_ask_bot"

# –°–õ–û–ñ–ù–´–ï –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–∞–≥–∞–¥–∫–∏
RIDDLES = [
    {
        "question": "1. –í –∫–æ–º–Ω–∞—Ç–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è 3 –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è. –í —Å–æ—Å–µ–¥–Ω–µ–π –∫–æ–º–Ω–∞—Ç–µ - 3 –ª–∞–º–ø–æ—á–∫–∏, –∫–∞–∂–¥–∞—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ —Å–≤–æ–µ–º—É –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—é. –í—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É —Å –ª–∞–º–ø–æ—á–∫–∞–º–∏ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑. –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å –∫ –∫–∞–∫–æ–π –ª–∞–º–ø–æ—á–∫–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è?",
        "options": [
            "–í–∫–ª—é—á–∏—Ç—å –≤—Å–µ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å",
            "–í–∫–ª—é—á–∏—Ç—å –¥–≤–∞ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è, –ø–æ–¥–æ–∂–¥–∞—Ç—å, –≤—ã–∫–ª—é—á–∏—Ç—å –æ–¥–∏–Ω –∏ –≤–æ–π—Ç–∏",
            "–í–∫–ª—é—á–∏—Ç—å –æ–¥–∏–Ω –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å –Ω–∞ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è, –≤—ã–∫–ª—é—á–∏—Ç—å, –≤–∫–ª—é—á–∏—Ç—å –¥—Ä—É–≥–æ–π –∏ –≤–æ–π—Ç–∏",
            "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–µ—Ä–∫–∞–ª–æ —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏–∑ –¥—Ä—É–≥–æ–π –∫–æ–º–Ω–∞—Ç—ã"
        ],
        "correct": 2
    },
    {
        "question": "2. –£ —á–µ–ª–æ–≤–µ–∫–∞ –µ—Å—Ç—å 2 –ø–µ—Å–æ—á–Ω—ã—Ö —á–∞—Å–∞: –Ω–∞ 7 –º–∏–Ω—É—Ç –∏ –Ω–∞ 11 –º–∏–Ω—É—Ç. –ö–∞–∫ –µ–º—É –æ—Ç–º–µ—Ä–∏—Ç—å —Ä–æ–≤–Ω–æ 15 –º–∏–Ω—É—Ç?",
        "options": [
            "–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–æ–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ –∂–¥–∞—Ç—å",
            "–°–Ω–∞—á–∞–ª–∞ 7 –º–∏–Ω—É—Ç, –ø–æ—Ç–æ–º 11 –º–∏–Ω—É—Ç, –ø–æ—Ç–æ–º –µ—â–µ 7 –º–∏–Ω—É—Ç",
            "–ó–∞–ø—É—Å—Ç–∏—Ç—å 7 –∏ 11 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –∫–æ–≥–¥–∞ 7 –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è - –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å 11",
            "–ó–∞–ø—É—Å—Ç–∏—Ç—å 7 –∏ 11, –∫–æ–≥–¥–∞ 7 –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è - –Ω–∞—á–∞—Ç—å –æ—Ç—Å—á–µ—Ç, –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è 11 - –µ—â–µ 7 –º–∏–Ω—É—Ç"
        ],
        "correct": 2
    },
    {
        "question": "3. –ï—Å—Ç—å 8 —à–∞—Ä–æ–≤, –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö —Ç—è–∂–µ–ª–µ–µ. –ó–∞ 2 –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è –Ω–∞ –≤–µ—Å–∞—Ö –±–µ–∑ –≥–∏—Ä—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—è–∂–µ–ª—ã–π —à–∞—Ä.",
        "options": [
            "–í–∑–≤–µ—Å–∏—Ç—å 4 –ø—Ä–æ—Ç–∏–≤ 4, –ø–æ—Ç–æ–º 2 –ø—Ä–æ—Ç–∏–≤ 2",
            "–í–∑–≤–µ—Å–∏—Ç—å 3 –ø—Ä–æ—Ç–∏–≤ 3, –µ—Å–ª–∏ —Ä–∞–≤–Ω—ã - –≤–∑–≤–µ—Å–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è 2",
            "–í–∑–≤–µ—Å–∏—Ç—å 6 –ø—Ä–æ—Ç–∏–≤ 2, –ø–æ—Ç–æ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–∑ —Ç—è–∂–µ–ª–æ–π –≥—Ä—É–ø–ø—ã",
            "–í–∑–≤–µ—Å–∏—Ç—å 3 –ø—Ä–æ—Ç–∏–≤ 3, –µ—Å–ª–∏ –Ω–µ —Ä–∞–≤–Ω—ã - –∏–∑ —Ç—è–∂–µ–ª–æ–π —Ç—Ä–æ–π–∫–∏ –≤–∑–≤–µ—Å–∏—Ç—å 1 –ø—Ä–æ—Ç–∏–≤ 1"
        ],
        "correct": 3
    },
    {
        "question": "4. –î–≤–∞ —á–µ–ª–æ–≤–µ–∫–∞ –ø–æ–¥–æ—à–ª–∏ –∫ —Ä–µ–∫–µ. –£ –±–µ—Ä–µ–≥–∞ —Å—Ç–æ–∏—Ç –ª–æ–¥–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –≤—ã–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –û–±–∞ —á–µ–ª–æ–≤–µ–∫–∞ –ø–µ—Ä–µ–ø—Ä–∞–≤–∏–ª–∏—Å—å –Ω–∞ –¥—Ä—É–≥–æ–π –±–µ—Ä–µ–≥. –ö–∞–∫?",
        "options": [
            "–û–Ω–∏ –ø–µ—Ä–µ–ø–ª—ã–ª–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏",
            "–û–Ω–∏ –±—ã–ª–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –±–µ—Ä–µ–≥–∞—Ö –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ",
            "–û–¥–∏–Ω –±—ã–ª –Ω–∞ –ª–æ–¥–∫–µ, –¥—Ä—É–≥–æ–π –≤–ø–ª–∞–≤—å",
            "–õ–æ–¥–∫–∞ –±—ã–ª–∞ —Å –º–æ—Ç–æ—Ä–æ–º"
        ],
        "correct": 1
    },
    {
        "question": "5. –ú—É–∂—á–∏–Ω–∞ –∑–∞—Ö–æ–¥–∏—Ç –≤ –±–∞—Ä –∏ –ø—Ä–æ—Å–∏—Ç —É –±–∞—Ä–º–µ–Ω–∞ —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã. –ë–∞—Ä–º–µ–Ω –≤–Ω–µ–∑–∞–ø–Ω–æ –¥–æ—Å—Ç–∞–µ—Ç –ø–∏—Å—Ç–æ–ª–µ—Ç –∏ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –º—É–∂—á–∏–Ω—É. –ú—É–∂—á–∏–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç '—Å–ø–∞—Å–∏–±–æ' –∏ —É—Ö–æ–¥–∏—Ç. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ?",
        "options": [
            "–ë–∞—Ä–º–µ–Ω –±—ã–ª –ø—Å–∏—Ö–æ–º",
            "–£ –º—É–∂—á–∏–Ω—ã –±—ã–ª–∞ –∏–∫–æ—Ç–∞, –∞ –∏—Å–ø—É–≥ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç –∏–∫–æ—Ç—ã",
            "–≠—Ç–æ –±—ã–ª –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Å—Ç—Ä–µ—á–∏ —Å–æ —à–ø–∏–æ–Ω–æ–º",
            "–ú—É–∂—á–∏–Ω–∞ —Ö–æ—Ç–µ–ª –ø–æ–∫–æ–Ω—á–∏—Ç—å —Å —Å–æ–±–æ–π, –Ω–æ –ø–µ—Ä–µ–¥—É–º–∞–ª"
        ],
        "correct": 1
    },
    {
        "question": "6. –ï—Å—Ç—å 5 –º–µ—à–∫–æ–≤ —Å –º–æ–Ω–µ—Ç–∞–º–∏. –í 4 –º–µ—à–∫–∞—Ö –≤—Å–µ –º–æ–Ω–µ—Ç—ã –Ω–∞—Å—Ç–æ—è—â–∏–µ (10 –≥), –≤ –æ–¥–Ω–æ–º - –≤—Å–µ —Ñ–∞–ª—å—à–∏–≤—ã–µ (9 –≥). –ö–∞–∫ –∑–∞ –æ–¥–Ω–æ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –≤–µ—Å–∞—Ö –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—à–æ–∫ —Å —Ñ–∞–ª—å—à–∏–≤—ã–º–∏ –º–æ–Ω–µ—Ç–∞–º–∏?",
        "options": [
            "–í–∑–≤–µ—Å–∏—Ç—å –≤—Å–µ –º–µ—à–∫–∏ –≤–º–µ—Å—Ç–µ",
            "–í–∑–≤–µ—Å–∏—Ç—å –ø–æ –æ–¥–Ω–æ–π –º–æ–Ω–µ—Ç–µ –∏–∑ –∫–∞–∂–¥–æ–≥–æ –º–µ—à–∫–∞",
            "–í–∑–≤–µ—Å–∏—Ç—å –ø–æ 2 –º–æ–Ω–µ—Ç—ã –∏–∑ –∫–∞–∂–¥–æ–≥–æ –º–µ—à–∫–∞",
            "–í–∑–≤–µ—Å–∏—Ç—å 1 –º–æ–Ω–µ—Ç—É –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –º–µ—à–∫–∞, 2 –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ, 3 –∏–∑ —Ç—Ä–µ—Ç—å–µ–≥–æ –∏ —Ç.–¥."
        ],
        "correct": 3
    },
    {
        "question": "7. –¢—Ä–∏ –º—É–¥—Ä–µ—Ü–∞ —Å–∏–¥—è—Ç –≤ —Ä—è–¥ –¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º —Ç–∞–∫, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–¥–∏—Ç –¥–≤—É—Ö –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π, —Å—Ä–µ–¥–Ω–∏–π - –æ–¥–Ω–æ–≥–æ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π, –∞ –ø–µ—Ä–≤—ã–π - –Ω–∏–∫–æ–≥–æ. –ù–∞–¥–µ–≤–∞—é—Ç –∏–º –Ω–∞ –≥–æ–ª–æ–≤—ã —á–µ—Ä–Ω—ã–µ –∏–ª–∏ –±–µ–ª—ã–µ –∫–æ–ª–ø–∞–∫–∏ (—Ü–≤–µ—Ç–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª—É—á–∞–π–Ω–æ). –ö–∞–∂–¥—ã–π –¥–æ–ª–∂–µ–Ω –Ω–∞–∑–≤–∞—Ç—å —Ü–≤–µ—Ç —Å–≤–æ–µ–≥–æ –∫–æ–ª–ø–∞–∫–∞. –û–Ω–∏ –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å –æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. –ö–∞–∫ –æ–Ω–∏ –≤—Å–µ —Ç—Ä–æ–µ –º–æ–≥—É—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–∞–∑–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ü–≤–µ—Ç?",
        "options": [
            "–¢–æ—Ç –∫—Ç–æ –≤–∏–¥–∏—Ç –¥–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ü–≤–µ—Ç–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–π",
            "–¢–æ—Ç –∫—Ç–æ –≤–∏–¥–∏—Ç –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Ü–≤–µ—Ç–∞ –º–æ–ª—á–∏—Ç",
            "–û–Ω–∏ –Ω–∞–∑—ã–≤–∞—é—Ç —Ü–≤–µ—Ç–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞—á–∏–Ω–∞—è —Å –∑–∞–¥–Ω–µ–≥–æ",
            "–ó–∞–¥–Ω–∏–π –≥–æ–≤–æ—Ä–∏—Ç —Ü–≤–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ, —Å—Ä–µ–¥–Ω–∏–π - —Ü–≤–µ—Ç –ø–µ—Ä–µ–¥–Ω–µ–≥–æ"
        ],
        "correct": 2
    },
    {
        "question": "8. –£ –≤–∞—Å –µ—Å—Ç—å –¥–≤–∞ —à–Ω—É—Ä–∞, –∫–∞–∂–¥—ã–π –≥–æ—Ä–∏—Ç —Ä–æ–≤–Ω–æ 60 –º–∏–Ω—É—Ç, –Ω–æ –≥–æ—Ä—è—Ç –æ–Ω–∏ –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ (–ø–æ–ª–æ–≤–∏–Ω–∞ —à–Ω—É—Ä–∞ –º–æ–∂–µ—Ç —Å–≥–æ—Ä–µ—Ç—å –∑–∞ 10 –º–∏–Ω—É—Ç, –∞ –≤—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ - –∑–∞ 50). –ö–∞–∫ –æ—Ç–º–µ—Ä–∏—Ç—å 45 –º–∏–Ω—É—Ç?",
        "options": [
            "–ü–æ–¥–∂–µ—á—å –æ–±–∞ —à–Ω—É—Ä–∞ —Å –¥–≤—É—Ö –∫–æ–Ω—Ü–æ–≤",
            "–ü–æ–¥–∂–µ—á—å –ø–µ—Ä–≤—ã–π —à–Ω—É—Ä —Å –¥–≤—É—Ö –∫–æ–Ω—Ü–æ–≤, –∫–æ–≥–¥–∞ —Å–≥–æ—Ä–∏—Ç - –ø–æ–¥–∂–µ—á—å –≤—Ç–æ—Ä–æ–π —Å –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ü–∞",
            "–ü–æ–¥–∂–µ—á—å –ø–µ—Ä–≤—ã–π —Å –¥–≤—É—Ö –∫–æ–Ω—Ü–æ–≤ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—Ç–æ—Ä–æ–π —Å –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ü–∞",
            "–ü–æ–¥–∂–µ—á—å –ø–µ—Ä–≤—ã–π —Å –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ü–∞, –∫–æ–≥–¥–∞ —Å–≥–æ—Ä–∏—Ç - –ø–æ–¥–∂–µ—á—å –≤—Ç–æ—Ä–æ–π —Å –¥–≤—É—Ö –∫–æ–Ω—Ü–æ–≤"
        ],
        "correct": 2
    },
    {
        "question": "9. –í —Ç–µ–º–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ –µ—Å—Ç—å –∫–æ—Ä–æ–±–∫–∞ —Å 10 –∫—Ä–∞—Å–Ω—ã–º–∏ –∏ 10 —Å–∏–Ω–∏–º–∏ –Ω–æ—Å–∫–∞–º–∏. –ö–∞–∫–æ–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ—Å–∫–æ–≤ –Ω—É–∂–Ω–æ –≤–∑—è—Ç—å, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä—É –æ–¥–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞?",
        "options": [
            "2 –Ω–æ—Å–∫–∞",
            "3 –Ω–æ—Å–∫–∞",
            "11 –Ω–æ—Å–∫–æ–≤",
            "20 –Ω–æ—Å–∫–æ–≤"
        ],
        "correct": 1
    },
    {
        "question": "10. –ß–µ–ª–æ–≤–µ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ 10-–º —ç—Ç–∞–∂–µ –Ω–µ–±–æ—Å–∫—Ä–µ–±–∞. –ö–æ–≥–¥–∞ –∏–¥–µ—Ç –¥–æ–∂–¥—å, –æ–Ω –µ–¥–µ—Ç –Ω–∞ –ª–∏—Ñ—Ç–µ –¥–æ 1-–≥–æ —ç—Ç–∞–∂–∞. –ö–æ–≥–¥–∞ —Å–æ–ª–Ω–µ—á–Ω–æ - –¥–æ 7-–≥–æ —ç—Ç–∞–∂–∞, –∞ –¥–∞–ª—å—à–µ –ø–µ—à–∫–æ–º. –ü–æ—á–µ–º—É?",
        "options": [
            "–û–Ω –±–æ–∏—Ç—Å—è –ª–∏—Ñ—Ç–∞ –≤ –¥–æ–∂–¥—å",
            "–û–Ω –∫–∞—Ä–ª–∏–∫ –∏ –Ω–µ –¥–æ—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –¥–æ –∫–Ω–æ–ø–∫–∏ 10-–≥–æ —ç—Ç–∞–∂–∞ –≤ –ª–∏—Ñ—Ç–µ",
            "–û–Ω –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –∫–æ–≥–æ-—Ç–æ –Ω–∞ 7-–º —ç—Ç–∞–∂–µ",
            "–û–Ω —ç–∫–æ–Ω–æ–º–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ"
        ],
        "correct": 1
    }
]

# –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_states = {}


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start"""
    user_id = update.effective_user.id

    start_text = (
        "–Ø —Å–ª—ã—à–∞–ª, —á—Ç–æ –î–∏–º–∞ —Å–µ—Å—Å–∏–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –Ω–∞ 4-5. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É–∑–Ω–∞—Ç—å –Ω–∞ —á—Ç–æ —Å–ø–æ—Å–æ–±–µ–Ω —Ç—ã —Ö–∞ —Ö–∞ —Ö–∞. "
        "–†–µ—à–∏ –º–æ–∏ –°–õ–û–ñ–ù–´–ï –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–∞–≥–∞–¥–∫–∏ –∏ —è –¥–∞–º —Ç–µ–±–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫—É—Å–æ–∫ –∫–æ–¥–∞!"
    )

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
    keyboard = [[InlineKeyboardButton("–ù–∞—á–∞—Ç—å –∏—Å–ø—ã—Ç–∞–Ω–∏–µ", callback_data="start_challenge")]]
    reply_markup = InlineKeyboardMarkup(keyboard)

    if update.callback_query:
        await update.callback_query.message.reply_text(start_text, reply_markup=reply_markup)
    else:
        await update.message.reply_text(start_text, reply_markup=reply_markup)


async def start_challenge(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int) -> None:
    """–ù–∞—á–∏–Ω–∞–µ—Ç –∏—Å–ø—ã—Ç–∞–Ω–∏–µ"""
    # –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã
    shuffled_riddles = random.sample(RIDDLES, 5)  # –ë–µ—Ä–µ–º 5 —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–≥–∞–¥–æ–∫ –∏–∑ 10

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_states[user_id] = {
        "current_question": 0,
        "correct_answers": 0,
        "game_active": True,
        "questions": shuffled_riddles
    }

    await send_question(update, context, user_id)


async def send_question(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int) -> None:
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
    user_state = user_states[user_id]
    current_q_index = user_state["current_question"]

    if current_q_index >= len(user_state["questions"]):
        await finish_challenge(update, context, user_id)
        return

    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å
    question_data = user_state["questions"][current_q_index]

    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤
    keyboard = []
    for i, option in enumerate(question_data["options"]):
        keyboard.append([InlineKeyboardButton(option, callback_data=f"answer_{i}")])

    reply_markup = InlineKeyboardMarkup(keyboard)

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤–æ–ø—Ä–æ—Å
    if update.callback_query:
        await update.callback_query.message.reply_text(question_data["question"], reply_markup=reply_markup)
    else:
        await update.message.reply_text(question_data["question"], reply_markup=reply_markup)


async def button_handler(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏"""
    query = update.callback_query
    await query.answer()

    user_id = query.from_user.id

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å –∏—Å–ø—ã—Ç–∞–Ω–∏–µ"
    if query.data == "start_challenge":
        await start_challenge(update, context, user_id)
        return

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ"
    if query.data == "restart_challenge":
        await start_challenge(update, context, user_id)
        return

    if user_id not in user_states or not user_states[user_id]["game_active"]:
        await query.message.reply_text("–ù–∞—á–Ω–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã /start")
        return

    if query.data.startswith("answer_"):
        answer_index = int(query.data.split("_")[1])
        await check_answer(update, context, user_id, answer_index)


async def check_answer(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int, answer_index: int) -> None:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    user_state = user_states[user_id]
    current_q_index = user_state["current_question"]
    question_data = user_state["questions"][current_q_index]

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
    if answer_index == question_data["correct"]:
        user_state["correct_answers"] += 1

    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
    user_state["current_question"] += 1

    # –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –≤–æ–ø—Ä–æ—Å–æ–º
    await asyncio.sleep(1)
    await send_question(update, context, user_id)


async def finish_challenge(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int) -> None:
    """–ó–∞–≤–µ—Ä—à–∞–µ—Ç –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç"""
    user_state = user_states[user_id]
    correct_answers = user_state["correct_answers"]
    total_questions = len(user_state["questions"])

    user_state["game_active"] = False

    if correct_answers == total_questions:
        # –í—Å–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
        win_text = (
            "–ê —Ç—ã —É–º–µ–Ω —Ö–∞ —Ö–∞ —Ö–∞. –í–∏–¥–Ω–æ –î–∏–º–∞ —É–º–µ–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –¥—Ä—É–∑–µ–π —Ö–∞ —Ö–∞ —Ö–∞.\n\n"
            "–ö–æ–¥ —Ç–µ–±–µ —Ç–∞–∫–æ–π. –í —ç—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ–Ω, –ø—Ä–æ—Å—Ç–æ –≤ –¥—Ä—É–≥–æ–º —Å–∫–ª–æ–Ω–µ–Ω–∏–∏ —Ö–∞ —Ö–∞ —Ö–∞.\n\n"
            f"–í–æ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–ª–µ–Ω –Ω–∞—à–µ–π –∫–æ–º–ø–∞—à–∫–∏, –ø–æ—Å–ø–µ—à–∏ –∏–Ω–∞—á–µ –î–∏–º–µ —Ö–∞–Ω–∞ —Ö–∞ —Ö–∞ —Ö–∞:\n{NEXT_BOT_LINK}"
        )
        await update.callback_query.message.reply_text(win_text)
    else:
        # –ù–µ –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
        lose_text = f"–ì–ª—É–ø—ã–π, —ç—Ç–æ –∂–µ –∏–∑–∏ —Ö–∞ —Ö–∞ —Ö–∞. –¢—ã –Ω–∞–±—Ä–∞–ª {correct_answers} –∏–∑ {total_questions}"

        # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
        keyboard = [[InlineKeyboardButton("–Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ", callback_data="restart_challenge")]]
        reply_markup = InlineKeyboardMarkup(keyboard)

        await update.callback_query.message.reply_text(lose_text, reply_markup=reply_markup)


async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help"""
    help_text = """
ü§ñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:
/start - –ù–∞—á–∞—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ
/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É

üéØ –ò—Å–ø—ã—Ç–∞–Ω–∏–µ:
‚Ä¢ 5 –°–õ–û–ñ–ù–´–• –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∑–∞–≥–∞–¥–æ–∫
‚Ä¢ –í—ã–±–∏—Ä–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—ã —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–æ–∫
‚Ä¢ –ü–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
‚Ä¢ –í–æ–ø—Ä–æ—Å—ã –º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ!
    """
    await update.message.reply_text(help_text)


async def handle_text(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    user_id = update.effective_user.id

    if user_id in user_states and user_states[user_id]["game_active"]:
        await update.message.reply_text("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–∏—Ä–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—ã —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–æ–∫ –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–∞–º–∏.")
    else:
        await update.message.reply_text("–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –∏–ª–∏ /help –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏.")


def main() -> None:
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞"""
    application = Application.builder().token(BOT_TOKEN).build()

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("help", help_command))
    application.add_handler(
        CallbackQueryHandler(button_handler, pattern="^(start_challenge|answer_|restart_challenge)"))

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_text))

    print("–ë–æ—Ç —Å–æ –°–õ–û–ñ–ù–´–ú–ò –ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–≥–∞–¥–∫–∞–º–∏ –∑–∞–ø—É—â–µ–Ω...")
    application.run_polling()


if __name__ == "__main__":
    import asyncio

    main()